import{c as T,u as C,r as x,j as e,C as p,a as j,b,H as w,B as y,d as f,e as N,f as H,g as V,h as A,T as B,i as M,k as P}from"./index-OkmmFMeI.js";import{F as S}from"./flame-BDKq2q0w.js";import{V as D}from"./ViewLayout-Bnv45DD-.js";import{S as g}from"./formatters-BjN0d5cq.js";import{T as z}from"./TaskCard-CWj4oMcv.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v=T("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),R=()=>{const s=C(),r=x.useMemo(()=>s.tasks.filter(a=>!a.isCompleted),[s.tasks]),i=x.useMemo(()=>new Set(s.pinnedTasks),[s.pinnedTasks]),n=x.useMemo(()=>r.filter(a=>i.has(a.id)),[r,i]),m=x.useMemo(()=>{const a=n.slice(0,3),c=r.filter(t=>!t.parentId&&!i.has(t.id)).sort((t,l)=>t.estimatedTime-l.estimatedTime).slice(0,5-a.length);return[...a,...c]},[r,n,i]),h=x.useMemo(()=>s.projects.find(a=>a.status==="in-progress"),[s.projects]),o=x.useMemo(()=>{var a,c;return{totalTasks:r.length,completedToday:s.tasks.filter(t=>t.isCompleted).length,totalTime:r.reduce((t,l)=>t+l.estimatedTime,0),habitsCompletion:((c=(a=s._habitsData)==null?void 0:a.getTodayCompletionRate)==null?void 0:c.call(a))??0}},[r,s.tasks,s._habitsData]);return{data:{activeTasks:r,topPriorityTasks:m,pinnedTasks:n,activeProject:h,todayHabits:s.todayHabits,projects:s.projects,stats:o},state:{loading:!s.tasks,isEmpty:r.length===0&&s.todayHabits.length===0},actions:{toggleTaskCompletion:s.toggleTaskCompletion,toggleHabitCompletion:s.toggleHabitCompletion,addTask:s.addTask}}},E=({habits:s,completions:r,streaks:i,onToggle:n,onViewAll:m,loading:h})=>{const o=s.filter(t=>!r[t.id]),a=s.filter(t=>r[t.id]).length,c=o.length===0&&s.length>0;return e.jsxs(p,{className:"bg-card border-border",children:[e.jsx(j,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(b,{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(w,{className:"w-5 h-5 text-habit"}),"Habitudes du jour",s.length>0&&e.jsxs(y,{variant:"outline",className:"ml-2 bg-habit/10 text-habit border-habit/20",children:[a,"/",s.length]})]}),e.jsxs(f,{variant:"ghost",size:"sm",onClick:m,className:"text-xs",children:["Toutes les habitudes",e.jsx(v,{className:"w-3 h-3 ml-1"})]})]})}),e.jsx(N,{className:"pt-0",children:h?e.jsx("div",{className:"text-center py-8 text-muted-foreground text-sm",children:"Chargement..."}):s.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground text-sm",children:"Aucune habitude dÃ©finie"}):c?e.jsxs("div",{className:"text-center py-6",children:[e.jsx(H,{className:"w-12 h-12 text-system-success mx-auto mb-3"}),e.jsx("p",{className:"text-lg font-semibold text-foreground mb-1",children:"Bravo !"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Toutes les habitudes du jour sont complÃ©tÃ©es ðŸŽ‰"})]}):e.jsxs("div",{className:"space-y-2 max-h-[240px] overflow-y-auto",children:[o.slice(0,5).map(t=>{const l=i[t.id],u=(l==null?void 0:l.currentStreak)||0;return e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-accent rounded-lg hover:bg-accent/80 transition-colors group",children:[e.jsx(V,{checked:!1,onCheckedChange:()=>n(t.id),className:"border-habit data-[state=checked]:bg-habit data-[state=checked]:border-habit"}),e.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center text-lg bg-habit-light dark:bg-habit/20",children:t.icon||"ðŸ’ª"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-foreground truncate",children:t.name}),t.description&&e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:t.description})]}),u>0&&e.jsxs(y,{variant:"outline",className:"flex items-center gap-1 bg-habit/10 text-habit border-habit/20",children:[e.jsx(S,{className:"w-3 h-3"}),u]})]},t.id)}),o.length>5&&e.jsxs("p",{className:"text-xs text-muted-foreground text-center py-2",children:["+",o.length-5," autres habitudes"]})]})})]})},q=({className:s})=>{const{setCurrentView:r}=A(),{data:i,state:n}=R(),{habitCompletions:m,habitStreaks:h,toggleHabitCompletion:o,habitsLoading:a,calculateTotalTime:c}=C(),{topPriorityTasks:t,activeProject:l,todayHabits:u,stats:k}=i;return e.jsx(D,{header:{title:"Tableau de bord",subtitle:"Vue d'ensemble de votre journÃ©e",icon:e.jsx(P,{className:"w-5 h-5"})},state:n.loading?"loading":"success",className:s,children:e.jsxs("div",{className:"space-y-6 pb-20 md:pb-6",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(g,{value:i.projects.filter(d=>d.status==="in-progress").length,label:"Projets en cours",valueClassName:"text-project"}),e.jsx(g,{value:`${Object.values(m).filter(Boolean).length}/${u.length}`,label:"Habitudes du jour",valueClassName:"text-habit"}),e.jsx(g,{value:k.completedToday,label:"TerminÃ©es",valueClassName:"text-system-success"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(p,{className:"bg-card border-border",children:[e.jsx(j,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(b,{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(B,{className:"w-5 h-5 text-primary"}),"TÃ¢ches prioritaires"]}),e.jsxs(f,{variant:"ghost",size:"sm",onClick:()=>r("tasks"),className:"text-xs",children:["Voir tout",e.jsx(v,{className:"w-3 h-3 ml-1"})]})]})}),e.jsx(N,{className:"pt-0",children:t.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground text-sm",children:"Aucune tÃ¢che prioritaire"}):e.jsx("div",{className:"space-y-2 max-h-[280px] overflow-y-auto",children:t.map(d=>e.jsx(z,{task:d,totalTime:c(d),variant:"compact",showCategory:!0,showDuration:!0},d.id))})})]}),e.jsxs(p,{className:"bg-card border-border",children:[e.jsx(j,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(b,{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(M,{className:"w-5 h-5 text-project"}),"Projet en cours"]}),e.jsxs(f,{variant:"ghost",size:"sm",onClick:()=>r("projects"),className:"text-xs",children:["Tous les projets",e.jsx(v,{className:"w-3 h-3 ml-1"})]})]})}),e.jsx(N,{className:"pt-0",children:l?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center text-2xl",style:{backgroundColor:l.color+"20"},children:l.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-foreground",children:l.name}),e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:l.description})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between text-sm mb-2",children:[e.jsx("span",{className:"text-muted-foreground",children:"Progression"}),e.jsxs("span",{className:"font-semibold text-project",children:[l.progress||0,"%"]})]}),e.jsx("div",{className:"w-full bg-border rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:"h-full bg-project transition-all duration-500",style:{width:`${l.progress||0}%`}})})]})]}):e.jsx("div",{className:"text-center py-8 text-muted-foreground text-sm",children:"Aucun projet actif"})})]}),e.jsx(E,{habits:u,completions:m,streaks:h,onToggle:d=>o(d),onViewAll:()=>r("habits"),loading:a})]})]})})};export{q as default};
