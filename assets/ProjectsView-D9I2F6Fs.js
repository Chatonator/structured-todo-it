import{c as lt,K as Cn,r as i,j as s,C as jn,a as ur,b as fr,B as De,e as Sn,P as Dn,D as Nn,l as hr,M as Rn,N as Tn,O as kn,Q as En,R as ye,I as Ye,n as pt,o as mt,p as vt,q as bt,s as xt,d as P,U as gr,V as H,g as pr,t as mr,W as At,X as Rt,Y as Ue,Z as vr,_ as Mn,$ as br,a0 as xr,a1 as In,a2 as wr,a3 as yr,a4 as Cr,a5 as jr,a6 as Sr,a7 as Dr,a8 as Nr,T as Rr,m as Tr,a9 as Jt,aa as Qt,ab as kr,ac as Zt,ad as en,ae as tn,af as nn,A as Er,ag as Mr,ah as Ir,ai as Ar,aj as Or,ak as wt,al as yt,i as Lr}from"./index-OkmmFMeI.js";import{V as Pr}from"./ViewLayout-Bnv45DD-.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rn=lt("FolderPlus",[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zr=lt("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fr=lt("ListPlus",[["path",{d:"M11 12H3",key:"51ecnj"}],["path",{d:"M16 6H3",key:"1wxfjs"}],["path",{d:"M16 18H3",key:"12xzn7"}],["path",{d:"M18 9v6",key:"1twb98"}],["path",{d:"M21 12h-6",key:"bt1uis"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sn=lt("Settings2",[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]]),Ot={planning:{label:"Planification",color:"text-blue-600",bgColor:"bg-blue-100"},"in-progress":{label:"En cours",color:"text-project",bgColor:"bg-project/10"},"on-hold":{label:"En pause",color:"text-orange-600",bgColor:"bg-orange-100"},completed:{label:"TerminÃ©",color:"text-green-600",bgColor:"bg-green-100"},archived:{label:"ArchivÃ©",color:"text-muted-foreground",bgColor:"bg-muted"}},Br=["ðŸ“š","ðŸŽ¯","ðŸ’¼","ðŸ ","âœˆï¸","ðŸŽ¨","ðŸ’¡","ðŸš€","ðŸŽ“","â¤ï¸"],$r=["#a78bfa","#ec4899","#f59e0b","#10b981","#3b82f6","#ef4444"],Ur=e=>{const{items:t}=Cn({contextTypes:["project_task"]});return i.useMemo(()=>{const r=t.filter(l=>l.parentId===e),o=r.length;if(o===0)return 0;const a=r.filter(l=>l.isCompleted).length;return Math.round(a/o*100)},[t,e])},Ct=({project:e,onClick:t})=>{const n=Ot[e.status],r=Ur(e.id);return s.jsxs(jn,{className:"cursor-pointer hover:shadow-lg transition-all",onClick:t,style:{borderLeftColor:e.color,borderLeftWidth:"4px"},children:[s.jsx(ur,{className:"pb-3",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[s.jsx("span",{className:"text-2xl",children:e.icon||"ðŸ“š"}),s.jsx(fr,{className:"text-lg",children:e.name})]}),s.jsx(De,{className:n.bgColor+" "+n.color,children:n.label})]})}),s.jsxs(Sn,{className:"space-y-3",children:[e.description&&s.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:e.description}),s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{className:"text-muted-foreground",children:"Progression"}),s.jsxs("span",{className:"font-medium",children:[r,"%"]})]}),s.jsx(Dn,{value:r,className:"h-2"})]}),e.targetDate&&s.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[s.jsx(Nn,{className:"w-4 h-4"}),s.jsx("span",{children:new Date(e.targetDate).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"})})]})]})]})},An=i.forwardRef(({className:e,...t},n)=>s.jsx("textarea",{className:hr("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:n,...t}));An.displayName="Textarea";const on=({open:e,onClose:t,onSave:n,project:r,initialName:o})=>{const[a,l]=i.useState(""),[c,d]=i.useState(""),[f,u]=i.useState("ðŸ“š"),[h,m]=i.useState("#a78bfa"),[g,w]=i.useState("planning"),[v,b]=i.useState("");i.useEffect(()=>{r?(l(r.name),d(r.description||""),u(r.icon||"ðŸ“š"),m(r.color),w(r.status),b(r.targetDate?r.targetDate.toISOString().split("T")[0]:"")):(l(o||""),d(""),u("ðŸ“š"),m("#a78bfa"),w("planning"),b(""))},[r,o,e]);const x=p=>{p.preventDefault(),n({name:a,description:c||void 0,icon:f,color:h,status:g,targetDate:v?new Date(v):void 0}),t()};return s.jsx(Rn,{open:e,onOpenChange:t,children:s.jsxs(Tn,{className:"sm:max-w-[500px]",children:[s.jsx(kn,{children:s.jsx(En,{children:r?"Modifier le projet":"Nouveau projet"})}),s.jsxs("form",{onSubmit:x,className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(ye,{htmlFor:"name",children:"Nom du projet *"}),s.jsx(Ye,{id:"name",value:a,onChange:p=>l(p.target.value),placeholder:"Ex: Ã‰crire un livre",required:!0})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ye,{htmlFor:"description",children:"Description"}),s.jsx(An,{id:"description",value:c,onChange:p=>d(p.target.value),placeholder:"DÃ©crivez votre projet...",rows:3})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(ye,{children:"IcÃ´ne"}),s.jsxs(pt,{value:f,onValueChange:u,children:[s.jsx(mt,{children:s.jsx(vt,{})}),s.jsx(bt,{children:Br.map(p=>s.jsx(xt,{value:p,children:s.jsx("span",{className:"text-xl",children:p})},p))})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ye,{children:"Couleur"}),s.jsxs(pt,{value:h,onValueChange:m,children:[s.jsx(mt,{children:s.jsx(vt,{})}),s.jsx(bt,{children:$r.map(p=>s.jsx(xt,{value:p,children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:p}}),p]})},p))})]})]})]}),r&&s.jsxs("div",{className:"space-y-2",children:[s.jsx(ye,{children:"Statut"}),s.jsxs(pt,{value:g,onValueChange:w,children:[s.jsx(mt,{children:s.jsx(vt,{})}),s.jsx(bt,{children:Object.entries(Ot).map(([p,y])=>s.jsx(xt,{value:p,children:y.label},p))})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ye,{htmlFor:"targetDate",children:"Date cible (optionnelle)"}),s.jsx(Ye,{id:"targetDate",type:"date",value:v,onChange:p=>b(p.target.value)})]}),s.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[s.jsx(P,{type:"button",variant:"outline",onClick:t,children:"Annuler"}),s.jsx(P,{type:"submit",children:r?"Mettre Ã  jour":"CrÃ©er"})]})]})]})})},Xr=["todo","in-progress","done"],Vr=e=>{const{items:t,loading:n,updateItem:r,reload:o}=Cn({contextTypes:["project_task"]}),a=i.useMemo(()=>t.filter(u=>u.parentId===e),[t,e]),l=i.useMemo(()=>a.map(gr),[a]),c=i.useCallback(async(u,h)=>{const m=a.find(w=>w.id===u);if(!m)return!1;const g=h==="done";try{return await r(u,{isCompleted:g,metadata:{...m.metadata,projectStatus:h}}),!0}catch{return!1}},[a,r]),d=i.useCallback(u=>{const h=(u==null?void 0:u.map(g=>g.id))||Xr,m={};return h.forEach(g=>{m[g]=[]}),l.forEach(g=>{var v;const w=g.projectStatus||"todo";if(m[w])m[w].push(g);else{const b=h[0]||"todo";(v=m[b])==null||v.push(g)}}),m},[l]),f=i.useMemo(()=>({todo:l.filter(u=>!u.projectStatus||u.projectStatus==="todo"),inProgress:l.filter(u=>u.projectStatus==="in-progress"),done:l.filter(u=>u.projectStatus==="done")}),[l]);return{tasks:l,loading:n,tasksByStatus:f,getTasksByColumns:d,updateTaskStatus:c,reloadTasks:o}},Kr=({priority:e})=>{if(!e)return null;const t=Rt[e],n={"Le plus important":"ðŸ”´",Important:"ðŸŸ ","Peut attendre":"ðŸŸ¡","Si j'ai le temps":"ðŸŸ¢"}[e]||"";return s.jsxs(De,{variant:"outline",className:`text-xs ${(t==null?void 0:t.color)||""}`,children:[n," ",e]})},Lt=[{id:"todo",name:"Ã€ faire",color:"bg-muted",order:0},{id:"in-progress",name:"En cours",color:"bg-project/10",order:1},{id:"done",name:"TerminÃ©",color:"bg-green-50 dark:bg-green-900/20",order:2}],Yr=({tasksByColumn:e,columns:t=Lt,onStatusChange:n,onTaskClick:r,onToggleComplete:o,onDeleteTask:a})=>{const l=i.useCallback(g=>e[g]||[],[e]),c=i.useCallback((g,w)=>{g.dataTransfer.setData("taskId",w)},[]),d=i.useCallback(g=>{g.preventDefault()},[]),f=i.useCallback((g,w)=>{g.preventDefault();const v=g.dataTransfer.getData("taskId");v&&n(v,w)},[n]),u=i.useCallback((g,w)=>{g.stopPropagation(),window.confirm("ÃŠtes-vous sÃ»r de vouloir supprimer cette tÃ¢che ?")&&a(w)},[a]),h=[...t].sort((g,w)=>g.order-w.order),m=h.length<=3?"md:grid-cols-3":h.length<=4?"md:grid-cols-4":"md:grid-cols-5";return s.jsx("div",{className:`grid grid-cols-1 ${m} gap-4`,children:h.map(g=>{const w=l(g.id);return s.jsxs("div",{className:"flex flex-col",onDragOver:d,onDrop:v=>f(v,g.id),children:[s.jsx("div",{className:`${g.color} rounded-t-lg p-3 border-b`,children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"font-semibold",children:g.name}),s.jsx(De,{variant:"secondary",children:w.length})]})}),s.jsx("div",{className:"space-y-2 p-2 min-h-[200px] bg-muted/20 rounded-b-lg",children:w.length===0?s.jsx("p",{className:"text-center text-muted-foreground text-sm py-8",children:"Aucune tÃ¢che"}):w.map(v=>s.jsx(jn,{draggable:!0,onDragStart:b=>c(b,v.id),className:"cursor-move hover:shadow-md transition-shadow group",children:s.jsx(Sn,{className:"p-3",children:s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(pr,{checked:v.isCompleted,onCheckedChange:()=>o(v.id),onClick:b=>b.stopPropagation()}),s.jsxs("div",{className:"flex-1 cursor-pointer",onClick:()=>r(v),children:[s.jsx("p",{className:`text-sm font-medium ${v.isCompleted?"line-through text-muted-foreground":""}`,children:v.name}),s.jsxs("div",{className:"flex items-center gap-2 mt-1 flex-wrap",children:[s.jsx(Kr,{priority:v.subCategory}),v.estimatedTime&&s.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[s.jsx(mr,{className:"w-3 h-3"}),v.estimatedTime,"min"]})]})]}),s.jsx(P,{variant:"ghost",size:"icon",className:"h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity text-destructive hover:text-destructive hover:bg-destructive/10",onClick:b=>u(b,v.id),children:s.jsx(At,{className:"w-3.5 h-3.5"})})]})})},v.id))})]},g.id)})})},Hr=H.memo(Yr);function Wr(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.useMemo(()=>r=>{t.forEach(o=>o(r))},t)}const ct=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Oe(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function Pt(e){return"nodeType"in e}function G(e){var t,n;return e?Oe(e)?e:Pt(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function zt(e){const{Document:t}=G(e);return e instanceof t}function Ge(e){return Oe(e)?!1:e instanceof G(e).HTMLElement}function On(e){return e instanceof G(e).SVGElement}function Le(e){return e?Oe(e)?e.document:Pt(e)?zt(e)?e:Ge(e)||On(e)?e.ownerDocument:document:document:document}const de=ct?i.useLayoutEffect:i.useEffect;function Ft(e){const t=i.useRef(e);return de(()=>{t.current=e}),i.useCallback(function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t.current==null?void 0:t.current(...r)},[])}function qr(){const e=i.useRef(null),t=i.useCallback((r,o)=>{e.current=setInterval(r,o)},[]),n=i.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function He(e,t){t===void 0&&(t=[e]);const n=i.useRef(e);return de(()=>{n.current!==e&&(n.current=e)},t),n}function Je(e,t){const n=i.useRef();return i.useMemo(()=>{const r=e(n.current);return n.current=r,r},[...t])}function st(e){const t=Ft(e),n=i.useRef(null),r=i.useCallback(o=>{o!==n.current&&(t==null||t(o,n.current)),n.current=o},[]);return[n,r]}function Tt(e){const t=i.useRef();return i.useEffect(()=>{t.current=e},[e]),t.current}let jt={};function Qe(e,t){return i.useMemo(()=>{if(t)return t;const n=jt[e]==null?0:jt[e]+1;return jt[e]=n,e+"-"+n},[e,t])}function Ln(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return r.reduce((a,l)=>{const c=Object.entries(l);for(const[d,f]of c){const u=a[d];u!=null&&(a[d]=u+e*f)}return a},{...t})}}const Ae=Ln(1),We=Ln(-1);function _r(e){return"clientX"in e&&"clientY"in e}function Bt(e){if(!e)return!1;const{KeyboardEvent:t}=G(e.target);return t&&e instanceof t}function Gr(e){if(!e)return!1;const{TouchEvent:t}=G(e.target);return t&&e instanceof t}function kt(e){if(Gr(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return _r(e)?{x:e.clientX,y:e.clientY}:null}const qe=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[qe.Translate.toString(e),qe.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:r}=e;return t+" "+n+"ms "+r}}}),an="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function Jr(e){return e.matches(an)?e:e.querySelector(an)}const Qr={display:"none"};function Zr(e){let{id:t,value:n}=e;return H.createElement("div",{id:t,style:Qr},n)}function es(e){let{id:t,announcement:n,ariaLiveType:r="assertive"}=e;const o={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return H.createElement("div",{id:t,style:o,role:"status","aria-live":r,"aria-atomic":!0},n)}function ts(){const[e,t]=i.useState("");return{announce:i.useCallback(r=>{r!=null&&t(r)},[]),announcement:e}}const Pn=i.createContext(null);function ns(e){const t=i.useContext(Pn);i.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function rs(){const[e]=i.useState(()=>new Set),t=i.useCallback(r=>(e.add(r),()=>e.delete(r)),[e]);return[i.useCallback(r=>{let{type:o,event:a}=r;e.forEach(l=>{var c;return(c=l[o])==null?void 0:c.call(l,a)})},[e]),t]}const ss={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},os={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function as(e){let{announcements:t=os,container:n,hiddenTextDescribedById:r,screenReaderInstructions:o=ss}=e;const{announce:a,announcement:l}=ts(),c=Qe("DndLiveRegion"),[d,f]=i.useState(!1);if(i.useEffect(()=>{f(!0)},[]),ns(i.useMemo(()=>({onDragStart(h){let{active:m}=h;a(t.onDragStart({active:m}))},onDragMove(h){let{active:m,over:g}=h;t.onDragMove&&a(t.onDragMove({active:m,over:g}))},onDragOver(h){let{active:m,over:g}=h;a(t.onDragOver({active:m,over:g}))},onDragEnd(h){let{active:m,over:g}=h;a(t.onDragEnd({active:m,over:g}))},onDragCancel(h){let{active:m,over:g}=h;a(t.onDragCancel({active:m,over:g}))}}),[a,t])),!d)return null;const u=H.createElement(H.Fragment,null,H.createElement(Zr,{id:r,value:o.draggable}),H.createElement(es,{id:c,announcement:l}));return n?Ue.createPortal(u,n):u}var z;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(z||(z={}));function ot(){}function ln(e,t){return i.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function is(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.useMemo(()=>[...t].filter(r=>r!=null),[...t])}const oe=Object.freeze({x:0,y:0});function zn(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Fn(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return n-r}function ls(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return r-n}function cn(e){let{left:t,top:n,height:r,width:o}=e;return[{x:t,y:n},{x:t+o,y:n},{x:t,y:n+r},{x:t+o,y:n+r}]}function Bn(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function dn(e,t,n){return t===void 0&&(t=e.left),n===void 0&&(n=e.top),{x:t+e.width*.5,y:n+e.height*.5}}const cs=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const o=dn(t,t.left,t.top),a=[];for(const l of r){const{id:c}=l,d=n.get(c);if(d){const f=zn(dn(d),o);a.push({id:c,data:{droppableContainer:l,value:f}})}}return a.sort(Fn)},ds=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const o=cn(t),a=[];for(const l of r){const{id:c}=l,d=n.get(c);if(d){const f=cn(d),u=o.reduce((m,g,w)=>m+zn(f[w],g),0),h=Number((u/4).toFixed(4));a.push({id:c,data:{droppableContainer:l,value:h}})}}return a.sort(Fn)};function us(e,t){const n=Math.max(t.top,e.top),r=Math.max(t.left,e.left),o=Math.min(t.left+t.width,e.left+e.width),a=Math.min(t.top+t.height,e.top+e.height),l=o-r,c=a-n;if(r<o&&n<a){const d=t.width*t.height,f=e.width*e.height,u=l*c,h=u/(d+f-u);return Number(h.toFixed(4))}return 0}const fs=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const o=[];for(const a of r){const{id:l}=a,c=n.get(l);if(c){const d=us(c,t);d>0&&o.push({id:l,data:{droppableContainer:a,value:d}})}}return o.sort(ls)};function hs(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function $n(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:oe}function gs(e){return function(n){for(var r=arguments.length,o=new Array(r>1?r-1:0),a=1;a<r;a++)o[a-1]=arguments[a];return o.reduce((l,c)=>({...l,top:l.top+e*c.y,bottom:l.bottom+e*c.y,left:l.left+e*c.x,right:l.right+e*c.x}),{...n})}}const ps=gs(1);function ms(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function vs(e,t,n){const r=ms(t);if(!r)return e;const{scaleX:o,scaleY:a,x:l,y:c}=r,d=e.left-l-(1-o)*parseFloat(n),f=e.top-c-(1-a)*parseFloat(n.slice(n.indexOf(" ")+1)),u=o?e.width/o:e.width,h=a?e.height/a:e.height;return{width:u,height:h,top:f,right:d+u,bottom:f+h,left:d}}const bs={ignoreTransform:!1};function Pe(e,t){t===void 0&&(t=bs);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:f,transformOrigin:u}=G(e).getComputedStyle(e);f&&(n=vs(n,f,u))}const{top:r,left:o,width:a,height:l,bottom:c,right:d}=n;return{top:r,left:o,width:a,height:l,bottom:c,right:d}}function un(e){return Pe(e,{ignoreTransform:!0})}function xs(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function ws(e,t){return t===void 0&&(t=G(e).getComputedStyle(e)),t.position==="fixed"}function ys(e,t){t===void 0&&(t=G(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(o=>{const a=t[o];return typeof a=="string"?n.test(a):!1})}function dt(e,t){const n=[];function r(o){if(t!=null&&n.length>=t||!o)return n;if(zt(o)&&o.scrollingElement!=null&&!n.includes(o.scrollingElement))return n.push(o.scrollingElement),n;if(!Ge(o)||On(o)||n.includes(o))return n;const a=G(e).getComputedStyle(o);return o!==e&&ys(o,a)&&n.push(o),ws(o,a)?n:r(o.parentNode)}return e?r(e):n}function Un(e){const[t]=dt(e,1);return t??null}function St(e){return!ct||!e?null:Oe(e)?e:Pt(e)?zt(e)||e===Le(e).scrollingElement?window:Ge(e)?e:null:null}function Xn(e){return Oe(e)?e.scrollX:e.scrollLeft}function Vn(e){return Oe(e)?e.scrollY:e.scrollTop}function Et(e){return{x:Xn(e),y:Vn(e)}}var B;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(B||(B={}));function Kn(e){return!ct||!e?!1:e===document.scrollingElement}function Yn(e){const t={x:0,y:0},n=Kn(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},o=e.scrollTop<=t.y,a=e.scrollLeft<=t.x,l=e.scrollTop>=r.y,c=e.scrollLeft>=r.x;return{isTop:o,isLeft:a,isBottom:l,isRight:c,maxScroll:r,minScroll:t}}const Cs={x:.2,y:.2};function js(e,t,n,r,o){let{top:a,left:l,right:c,bottom:d}=n;r===void 0&&(r=10),o===void 0&&(o=Cs);const{isTop:f,isBottom:u,isLeft:h,isRight:m}=Yn(e),g={x:0,y:0},w={x:0,y:0},v={height:t.height*o.y,width:t.width*o.x};return!f&&a<=t.top+v.height?(g.y=B.Backward,w.y=r*Math.abs((t.top+v.height-a)/v.height)):!u&&d>=t.bottom-v.height&&(g.y=B.Forward,w.y=r*Math.abs((t.bottom-v.height-d)/v.height)),!m&&c>=t.right-v.width?(g.x=B.Forward,w.x=r*Math.abs((t.right-v.width-c)/v.width)):!h&&l<=t.left+v.width&&(g.x=B.Backward,w.x=r*Math.abs((t.left+v.width-l)/v.width)),{direction:g,speed:w}}function Ss(e){if(e===document.scrollingElement){const{innerWidth:a,innerHeight:l}=window;return{top:0,left:0,right:a,bottom:l,width:a,height:l}}const{top:t,left:n,right:r,bottom:o}=e.getBoundingClientRect();return{top:t,left:n,right:r,bottom:o,width:e.clientWidth,height:e.clientHeight}}function Hn(e){return e.reduce((t,n)=>Ae(t,Et(n)),oe)}function Ds(e){return e.reduce((t,n)=>t+Xn(n),0)}function Ns(e){return e.reduce((t,n)=>t+Vn(n),0)}function Rs(e,t){if(t===void 0&&(t=Pe),!e)return;const{top:n,left:r,bottom:o,right:a}=t(e);Un(e)&&(o<=0||a<=0||n>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const Ts=[["x",["left","right"],Ds],["y",["top","bottom"],Ns]];class $t{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=dt(n),o=Hn(r);this.rect={...t},this.width=t.width,this.height=t.height;for(const[a,l,c]of Ts)for(const d of l)Object.defineProperty(this,d,{get:()=>{const f=c(r),u=o[a]-f;return this.rect[d]+u},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Xe{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=t}add(t,n,r){var o;(o=this.target)==null||o.addEventListener(t,n,r),this.listeners.push([t,n,r])}}function ks(e){const{EventTarget:t}=G(e);return e instanceof t?e:Le(e)}function Dt(e,t){const n=Math.abs(e.x),r=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+r**2)>t:"x"in t&&"y"in t?n>t.x&&r>t.y:"x"in t?n>t.x:"y"in t?r>t.y:!1}var ne;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(ne||(ne={}));function fn(e){e.preventDefault()}function Es(e){e.stopPropagation()}var T;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(T||(T={}));const Wn={start:[T.Space,T.Enter],cancel:[T.Esc],end:[T.Space,T.Enter,T.Tab]},Ms=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case T.Right:return{...n,x:n.x+25};case T.Left:return{...n,x:n.x-25};case T.Down:return{...n,y:n.y+25};case T.Up:return{...n,y:n.y-25}}};class Ut{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new Xe(Le(n)),this.windowListeners=new Xe(G(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(ne.Resize,this.handleCancel),this.windowListeners.add(ne.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(ne.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,r=t.node.current;r&&Rs(r),n(oe)}handleKeyDown(t){if(Bt(t)){const{active:n,context:r,options:o}=this.props,{keyboardCodes:a=Wn,coordinateGetter:l=Ms,scrollBehavior:c="smooth"}=o,{code:d}=t;if(a.end.includes(d)){this.handleEnd(t);return}if(a.cancel.includes(d)){this.handleCancel(t);return}const{collisionRect:f}=r.current,u=f?{x:f.left,y:f.top}:oe;this.referenceCoordinates||(this.referenceCoordinates=u);const h=l(t,{active:n,context:r.current,currentCoordinates:u});if(h){const m=We(h,u),g={x:0,y:0},{scrollableAncestors:w}=r.current;for(const v of w){const b=t.code,{isTop:x,isRight:p,isLeft:y,isBottom:j,maxScroll:N,minScroll:C}=Yn(v),D=Ss(v),R={x:Math.min(b===T.Right?D.right-D.width/2:D.right,Math.max(b===T.Right?D.left:D.left+D.width/2,h.x)),y:Math.min(b===T.Down?D.bottom-D.height/2:D.bottom,Math.max(b===T.Down?D.top:D.top+D.height/2,h.y))},O=b===T.Right&&!p||b===T.Left&&!y,L=b===T.Down&&!j||b===T.Up&&!x;if(O&&R.x!==h.x){const M=v.scrollLeft+m.x,W=b===T.Right&&M<=N.x||b===T.Left&&M>=C.x;if(W&&!m.y){v.scrollTo({left:M,behavior:c});return}W?g.x=v.scrollLeft-M:g.x=b===T.Right?v.scrollLeft-N.x:v.scrollLeft-C.x,g.x&&v.scrollBy({left:-g.x,behavior:c});break}else if(L&&R.y!==h.y){const M=v.scrollTop+m.y,W=b===T.Down&&M<=N.y||b===T.Up&&M>=C.y;if(W&&!m.x){v.scrollTo({top:M,behavior:c});return}W?g.y=v.scrollTop-M:g.y=b===T.Down?v.scrollTop-N.y:v.scrollTop-C.y,g.y&&v.scrollBy({top:-g.y,behavior:c});break}}this.handleMove(t,Ae(We(h,this.referenceCoordinates),g))}}}handleMove(t,n){const{onMove:r}=this.props;t.preventDefault(),r(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}Ut.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:r=Wn,onActivation:o}=t,{active:a}=n;const{code:l}=e.nativeEvent;if(r.start.includes(l)){const c=a.activatorNode.current;return c&&e.target!==c?!1:(e.preventDefault(),o==null||o({event:e.nativeEvent}),!0)}return!1}}];function hn(e){return!!(e&&"distance"in e)}function gn(e){return!!(e&&"delay"in e)}class Xt{constructor(t,n,r){var o;r===void 0&&(r=ks(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:a}=t,{target:l}=a;this.props=t,this.events=n,this.document=Le(l),this.documentListeners=new Xe(this.document),this.listeners=new Xe(r),this.windowListeners=new Xe(G(l)),this.initialCoordinates=(o=kt(a))!=null?o:oe,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(ne.Resize,this.handleCancel),this.windowListeners.add(ne.DragStart,fn),this.windowListeners.add(ne.VisibilityChange,this.handleCancel),this.windowListeners.add(ne.ContextMenu,fn),this.documentListeners.add(ne.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(gn(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(hn(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:r,onPending:o}=this.props;o(r,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(ne.Click,Es,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(ne.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:r,initialCoordinates:o,props:a}=this,{onMove:l,options:{activationConstraint:c}}=a;if(!o)return;const d=(n=kt(t))!=null?n:oe,f=We(o,d);if(!r&&c){if(hn(c)){if(c.tolerance!=null&&Dt(f,c.tolerance))return this.handleCancel();if(Dt(f,c.distance))return this.handleStart()}if(gn(c)&&Dt(f,c.tolerance))return this.handleCancel();this.handlePending(c,f);return}t.cancelable&&t.preventDefault(),l(d)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===T.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const Is={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class Vt extends Xt{constructor(t){const{event:n}=t,r=Le(n.target);super(t,Is,r)}}Vt.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return!n.isPrimary||n.button!==0?!1:(r==null||r({event:n}),!0)}}];const As={move:{name:"mousemove"},end:{name:"mouseup"}};var Mt;(function(e){e[e.RightClick=2]="RightClick"})(Mt||(Mt={}));class Os extends Xt{constructor(t){super(t,As,Le(t.event.target))}}Os.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return n.button===Mt.RightClick?!1:(r==null||r({event:n}),!0)}}];const Nt={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class Ls extends Xt{constructor(t){super(t,Nt)}static setup(){return window.addEventListener(Nt.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(Nt.move.name,t)};function t(){}}}Ls.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;const{touches:o}=n;return o.length>1?!1:(r==null||r({event:n}),!0)}}];var Ve;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Ve||(Ve={}));var at;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(at||(at={}));function Ps(e){let{acceleration:t,activator:n=Ve.Pointer,canScroll:r,draggingRect:o,enabled:a,interval:l=5,order:c=at.TreeOrder,pointerCoordinates:d,scrollableAncestors:f,scrollableAncestorRects:u,delta:h,threshold:m}=e;const g=Fs({delta:h,disabled:!a}),[w,v]=qr(),b=i.useRef({x:0,y:0}),x=i.useRef({x:0,y:0}),p=i.useMemo(()=>{switch(n){case Ve.Pointer:return d?{top:d.y,bottom:d.y,left:d.x,right:d.x}:null;case Ve.DraggableRect:return o}},[n,o,d]),y=i.useRef(null),j=i.useCallback(()=>{const C=y.current;if(!C)return;const D=b.current.x*x.current.x,R=b.current.y*x.current.y;C.scrollBy(D,R)},[]),N=i.useMemo(()=>c===at.TreeOrder?[...f].reverse():f,[c,f]);i.useEffect(()=>{if(!a||!f.length||!p){v();return}for(const C of N){if((r==null?void 0:r(C))===!1)continue;const D=f.indexOf(C),R=u[D];if(!R)continue;const{direction:O,speed:L}=js(C,R,p,t,m);for(const M of["x","y"])g[M][O[M]]||(L[M]=0,O[M]=0);if(L.x>0||L.y>0){v(),y.current=C,w(j,l),b.current=L,x.current=O;return}}b.current={x:0,y:0},x.current={x:0,y:0},v()},[t,j,r,v,a,l,JSON.stringify(p),JSON.stringify(g),w,f,N,u,JSON.stringify(m)])}const zs={x:{[B.Backward]:!1,[B.Forward]:!1},y:{[B.Backward]:!1,[B.Forward]:!1}};function Fs(e){let{delta:t,disabled:n}=e;const r=Tt(t);return Je(o=>{if(n||!r||!o)return zs;const a={x:Math.sign(t.x-r.x),y:Math.sign(t.y-r.y)};return{x:{[B.Backward]:o.x[B.Backward]||a.x===-1,[B.Forward]:o.x[B.Forward]||a.x===1},y:{[B.Backward]:o.y[B.Backward]||a.y===-1,[B.Forward]:o.y[B.Forward]||a.y===1}}},[n,t,r])}function Bs(e,t){const n=t!=null?e.get(t):void 0,r=n?n.node.current:null;return Je(o=>{var a;return t==null?null:(a=r??o)!=null?a:null},[r,t])}function $s(e,t){return i.useMemo(()=>e.reduce((n,r)=>{const{sensor:o}=r,a=o.activators.map(l=>({eventName:l.eventName,handler:t(l.handler,r)}));return[...n,...a]},[]),[e,t])}var _e;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(_e||(_e={}));var It;(function(e){e.Optimized="optimized"})(It||(It={}));const pn=new Map;function Us(e,t){let{dragging:n,dependencies:r,config:o}=t;const[a,l]=i.useState(null),{frequency:c,measure:d,strategy:f}=o,u=i.useRef(e),h=b(),m=He(h),g=i.useCallback(function(x){x===void 0&&(x=[]),!m.current&&l(p=>p===null?x:p.concat(x.filter(y=>!p.includes(y))))},[m]),w=i.useRef(null),v=Je(x=>{if(h&&!n)return pn;if(!x||x===pn||u.current!==e||a!=null){const p=new Map;for(let y of e){if(!y)continue;if(a&&a.length>0&&!a.includes(y.id)&&y.rect.current){p.set(y.id,y.rect.current);continue}const j=y.node.current,N=j?new $t(d(j),j):null;y.rect.current=N,N&&p.set(y.id,N)}return p}return x},[e,a,n,h,d]);return i.useEffect(()=>{u.current=e},[e]),i.useEffect(()=>{h||g()},[n,h]),i.useEffect(()=>{a&&a.length>0&&l(null)},[JSON.stringify(a)]),i.useEffect(()=>{h||typeof c!="number"||w.current!==null||(w.current=setTimeout(()=>{g(),w.current=null},c))},[c,h,g,...r]),{droppableRects:v,measureDroppableContainers:g,measuringScheduled:a!=null};function b(){switch(f){case _e.Always:return!1;case _e.BeforeDragging:return n;default:return!n}}}function qn(e,t){return Je(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function Xs(e,t){return qn(e,t)}function Vs(e){let{callback:t,disabled:n}=e;const r=Ft(t),o=i.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:a}=window;return new a(r)},[r,n]);return i.useEffect(()=>()=>o==null?void 0:o.disconnect(),[o]),o}function ut(e){let{callback:t,disabled:n}=e;const r=Ft(t),o=i.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:a}=window;return new a(r)},[n]);return i.useEffect(()=>()=>o==null?void 0:o.disconnect(),[o]),o}function Ks(e){return new $t(Pe(e),e)}function mn(e,t,n){t===void 0&&(t=Ks);const[r,o]=i.useState(null);function a(){o(d=>{if(!e)return null;if(e.isConnected===!1){var f;return(f=d??n)!=null?f:null}const u=t(e);return JSON.stringify(d)===JSON.stringify(u)?d:u})}const l=Vs({callback(d){if(e)for(const f of d){const{type:u,target:h}=f;if(u==="childList"&&h instanceof HTMLElement&&h.contains(e)){a();break}}}}),c=ut({callback:a});return de(()=>{a(),e?(c==null||c.observe(e),l==null||l.observe(document.body,{childList:!0,subtree:!0})):(c==null||c.disconnect(),l==null||l.disconnect())},[e]),r}function Ys(e){const t=qn(e);return $n(e,t)}const vn=[];function Hs(e){const t=i.useRef(e),n=Je(r=>e?r&&r!==vn&&e&&t.current&&e.parentNode===t.current.parentNode?r:dt(e):vn,[e]);return i.useEffect(()=>{t.current=e},[e]),n}function Ws(e){const[t,n]=i.useState(null),r=i.useRef(e),o=i.useCallback(a=>{const l=St(a.target);l&&n(c=>c?(c.set(l,Et(l)),new Map(c)):null)},[]);return i.useEffect(()=>{const a=r.current;if(e!==a){l(a);const c=e.map(d=>{const f=St(d);return f?(f.addEventListener("scroll",o,{passive:!0}),[f,Et(f)]):null}).filter(d=>d!=null);n(c.length?new Map(c):null),r.current=e}return()=>{l(e),l(a)};function l(c){c.forEach(d=>{const f=St(d);f==null||f.removeEventListener("scroll",o)})}},[o,e]),i.useMemo(()=>e.length?t?Array.from(t.values()).reduce((a,l)=>Ae(a,l),oe):Hn(e):oe,[e,t])}function bn(e,t){t===void 0&&(t=[]);const n=i.useRef(null);return i.useEffect(()=>{n.current=null},t),i.useEffect(()=>{const r=e!==oe;r&&!n.current&&(n.current=e),!r&&n.current&&(n.current=null)},[e]),n.current?We(e,n.current):oe}function qs(e){i.useEffect(()=>{if(!ct)return;const t=e.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of t)n==null||n()}},e.map(t=>{let{sensor:n}=t;return n}))}function _s(e,t){return i.useMemo(()=>e.reduce((n,r)=>{let{eventName:o,handler:a}=r;return n[o]=l=>{a(l,t)},n},{}),[e,t])}function _n(e){return i.useMemo(()=>e?xs(e):null,[e])}const xn=[];function Gs(e,t){t===void 0&&(t=Pe);const[n]=e,r=_n(n?G(n):null),[o,a]=i.useState(xn);function l(){a(()=>e.length?e.map(d=>Kn(d)?r:new $t(t(d),d)):xn)}const c=ut({callback:l});return de(()=>{c==null||c.disconnect(),l(),e.forEach(d=>c==null?void 0:c.observe(d))},[e]),o}function Js(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return Ge(t)?t:e}function Qs(e){let{measure:t}=e;const[n,r]=i.useState(null),o=i.useCallback(f=>{for(const{target:u}of f)if(Ge(u)){r(h=>{const m=t(u);return h?{...h,width:m.width,height:m.height}:m});break}},[t]),a=ut({callback:o}),l=i.useCallback(f=>{const u=Js(f);a==null||a.disconnect(),u&&(a==null||a.observe(u)),r(u?t(u):null)},[t,a]),[c,d]=st(l);return i.useMemo(()=>({nodeRef:c,rect:n,setRef:d}),[n,c,d])}const Zs=[{sensor:Vt,options:{}},{sensor:Ut,options:{}}],eo={current:{}},rt={draggable:{measure:un},droppable:{measure:un,strategy:_e.WhileDragging,frequency:It.Optimized},dragOverlay:{measure:Pe}};class Ke extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,r;return(n=(r=this.get(t))==null?void 0:r.node.current)!=null?n:void 0}}const to={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Ke,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:ot},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:rt,measureDroppableContainers:ot,windowRect:null,measuringScheduled:!1},no={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:ot,draggableNodes:new Map,over:null,measureDroppableContainers:ot},ft=i.createContext(no),Gn=i.createContext(to);function ro(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Ke}}}function so(e,t){switch(t.type){case z.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case z.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case z.DragEnd:case z.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case z.RegisterDroppable:{const{element:n}=t,{id:r}=n,o=new Ke(e.droppable.containers);return o.set(r,n),{...e,droppable:{...e.droppable,containers:o}}}case z.SetDroppableDisabled:{const{id:n,key:r,disabled:o}=t,a=e.droppable.containers.get(n);if(!a||r!==a.key)return e;const l=new Ke(e.droppable.containers);return l.set(n,{...a,disabled:o}),{...e,droppable:{...e.droppable,containers:l}}}case z.UnregisterDroppable:{const{id:n,key:r}=t,o=e.droppable.containers.get(n);if(!o||r!==o.key)return e;const a=new Ke(e.droppable.containers);return a.delete(n),{...e,droppable:{...e.droppable,containers:a}}}default:return e}}function oo(e){let{disabled:t}=e;const{active:n,activatorEvent:r,draggableNodes:o}=i.useContext(ft),a=Tt(r),l=Tt(n==null?void 0:n.id);return i.useEffect(()=>{if(!t&&!r&&a&&l!=null){if(!Bt(a)||document.activeElement===a.target)return;const c=o.get(l);if(!c)return;const{activatorNode:d,node:f}=c;if(!d.current&&!f.current)return;requestAnimationFrame(()=>{for(const u of[d.current,f.current]){if(!u)continue;const h=Jr(u);if(h){h.focus();break}}})}},[r,t,o,l,a]),null}function ao(e,t){let{transform:n,...r}=t;return e!=null&&e.length?e.reduce((o,a)=>a({transform:o,...r}),n):n}function io(e){return i.useMemo(()=>({draggable:{...rt.draggable,...e==null?void 0:e.draggable},droppable:{...rt.droppable,...e==null?void 0:e.droppable},dragOverlay:{...rt.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function lo(e){let{activeNode:t,measure:n,initialRect:r,config:o=!0}=e;const a=i.useRef(!1),{x:l,y:c}=typeof o=="boolean"?{x:o,y:o}:o;de(()=>{if(!l&&!c||!t){a.current=!1;return}if(a.current||!r)return;const f=t==null?void 0:t.node.current;if(!f||f.isConnected===!1)return;const u=n(f),h=$n(u,r);if(l||(h.x=0),c||(h.y=0),a.current=!0,Math.abs(h.x)>0||Math.abs(h.y)>0){const m=Un(f);m&&m.scrollBy({top:h.y,left:h.x})}},[t,l,c,r,n])}const Jn=i.createContext({...oe,scaleX:1,scaleY:1});var Ce;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(Ce||(Ce={}));const co=i.memo(function(t){var n,r,o,a;let{id:l,accessibility:c,autoScroll:d=!0,children:f,sensors:u=Zs,collisionDetection:h=fs,measuring:m,modifiers:g,...w}=t;const v=i.useReducer(so,void 0,ro),[b,x]=v,[p,y]=rs(),[j,N]=i.useState(Ce.Uninitialized),C=j===Ce.Initialized,{draggable:{active:D,nodes:R,translate:O},droppable:{containers:L}}=b,M=D!=null?R.get(D):null,W=i.useRef({initial:null,translated:null}),F=i.useMemo(()=>{var X;return D!=null?{id:D,data:(X=M==null?void 0:M.data)!=null?X:eo,rect:W}:null},[D,M]),V=i.useRef(null),[ge,Ne]=i.useState(null),[K,Re]=i.useState(null),re=He(w,Object.values(w)),je=Qe("DndDescribedBy",l),Te=i.useMemo(()=>L.getEnabled(),[L]),U=io(m),{droppableRects:se,measureDroppableContainers:ue,measuringScheduled:Se}=Us(Te,{dragging:C,dependencies:[O.x,O.y],config:U.droppable}),q=Bs(R,D),ke=i.useMemo(()=>K?kt(K):null,[K]),ae=dr(),ee=Xs(q,U.draggable.measure);lo({activeNode:D!=null?R.get(D):null,config:ae.layoutShiftCompensation,initialRect:ee,measure:U.draggable.measure});const k=mn(q,U.draggable.measure,ee),S=mn(q?q.parentElement:null),E=i.useRef({activatorEvent:null,active:null,activeNode:q,collisionRect:null,collisions:null,droppableRects:se,draggableNodes:R,draggingNode:null,draggingNodeRect:null,droppableContainers:L,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),I=L.getNodeFor((n=E.current.over)==null?void 0:n.id),A=Qs({measure:U.dragOverlay.measure}),Y=(r=A.nodeRef.current)!=null?r:q,_=C?(o=A.rect)!=null?o:k:null,ie=!!(A.nodeRef.current&&A.rect),pe=Ys(ie?null:k),fe=_n(Y?G(Y):null),me=Hs(C?I??q:null),Ze=Gs(me),et=ao(g,{transform:{x:O.x-pe.x,y:O.y-pe.y,scaleX:1,scaleY:1},activatorEvent:K,active:F,activeNodeRect:k,containerNodeRect:S,draggingNodeRect:_,over:E.current.over,overlayNodeRect:A.rect,scrollableAncestors:me,scrollableAncestorRects:Ze,windowRect:fe}),Yt=ke?Ae(ke,O):null,Ht=Ws(me),rr=bn(Ht),sr=bn(Ht,[k]),Ee=Ae(et,rr),Me=_?ps(_,et):null,ze=F&&Me?h({active:F,collisionRect:Me,droppableRects:se,droppableContainers:Te,pointerCoordinates:Yt}):null,Wt=Bn(ze,"id"),[ve,qt]=i.useState(null),or=ie?et:Ae(et,sr),ar=hs(or,(a=ve==null?void 0:ve.rect)!=null?a:null,k),ht=i.useRef(null),_t=i.useCallback((X,J)=>{let{sensor:Q,options:be}=J;if(V.current==null)return;const te=R.get(V.current);if(!te)return;const Z=X.nativeEvent,le=new Q({active:V.current,activeNode:te,event:Z,options:be,context:E,onAbort($){if(!R.get($))return;const{onDragAbort:ce}=re.current,he={id:$};ce==null||ce(he),p({type:"onDragAbort",event:he})},onPending($,xe,ce,he){if(!R.get($))return;const{onDragPending:Be}=re.current,we={id:$,constraint:xe,initialCoordinates:ce,offset:he};Be==null||Be(we),p({type:"onDragPending",event:we})},onStart($){const xe=V.current;if(xe==null)return;const ce=R.get(xe);if(!ce)return;const{onDragStart:he}=re.current,Fe={activatorEvent:Z,active:{id:xe,data:ce.data,rect:W}};Ue.unstable_batchedUpdates(()=>{he==null||he(Fe),N(Ce.Initializing),x({type:z.DragStart,initialCoordinates:$,active:xe}),p({type:"onDragStart",event:Fe}),Ne(ht.current),Re(Z)})},onMove($){x({type:z.DragMove,coordinates:$})},onEnd:Ie(z.DragEnd),onCancel:Ie(z.DragCancel)});ht.current=le;function Ie($){return async function(){const{active:ce,collisions:he,over:Fe,scrollAdjustedTranslate:Be}=E.current;let we=null;if(ce&&Be){const{cancelDrop:$e}=re.current;we={activatorEvent:Z,active:ce,collisions:he,delta:Be,over:Fe},$===z.DragEnd&&typeof $e=="function"&&await Promise.resolve($e(we))&&($=z.DragCancel)}V.current=null,Ue.unstable_batchedUpdates(()=>{x({type:$}),N(Ce.Uninitialized),qt(null),Ne(null),Re(null),ht.current=null;const $e=$===z.DragEnd?"onDragEnd":"onDragCancel";if(we){const gt=re.current[$e];gt==null||gt(we),p({type:$e,event:we})}})}}},[R]),ir=i.useCallback((X,J)=>(Q,be)=>{const te=Q.nativeEvent,Z=R.get(be);if(V.current!==null||!Z||te.dndKit||te.defaultPrevented)return;const le={active:Z};X(Q,J.options,le)===!0&&(te.dndKit={capturedBy:J.sensor},V.current=be,_t(Q,J))},[R,_t]),Gt=$s(u,ir);qs(u),de(()=>{k&&j===Ce.Initializing&&N(Ce.Initialized)},[k,j]),i.useEffect(()=>{const{onDragMove:X}=re.current,{active:J,activatorEvent:Q,collisions:be,over:te}=E.current;if(!J||!Q)return;const Z={active:J,activatorEvent:Q,collisions:be,delta:{x:Ee.x,y:Ee.y},over:te};Ue.unstable_batchedUpdates(()=>{X==null||X(Z),p({type:"onDragMove",event:Z})})},[Ee.x,Ee.y]),i.useEffect(()=>{const{active:X,activatorEvent:J,collisions:Q,droppableContainers:be,scrollAdjustedTranslate:te}=E.current;if(!X||V.current==null||!J||!te)return;const{onDragOver:Z}=re.current,le=be.get(Wt),Ie=le&&le.rect.current?{id:le.id,rect:le.rect.current,data:le.data,disabled:le.disabled}:null,$={active:X,activatorEvent:J,collisions:Q,delta:{x:te.x,y:te.y},over:Ie};Ue.unstable_batchedUpdates(()=>{qt(Ie),Z==null||Z($),p({type:"onDragOver",event:$})})},[Wt]),de(()=>{E.current={activatorEvent:K,active:F,activeNode:q,collisionRect:Me,collisions:ze,droppableRects:se,draggableNodes:R,draggingNode:Y,draggingNodeRect:_,droppableContainers:L,over:ve,scrollableAncestors:me,scrollAdjustedTranslate:Ee},W.current={initial:_,translated:Me}},[F,q,ze,Me,R,Y,_,se,L,ve,me,Ee]),Ps({...ae,delta:O,draggingRect:Me,pointerCoordinates:Yt,scrollableAncestors:me,scrollableAncestorRects:Ze});const lr=i.useMemo(()=>({active:F,activeNode:q,activeNodeRect:k,activatorEvent:K,collisions:ze,containerNodeRect:S,dragOverlay:A,draggableNodes:R,droppableContainers:L,droppableRects:se,over:ve,measureDroppableContainers:ue,scrollableAncestors:me,scrollableAncestorRects:Ze,measuringConfiguration:U,measuringScheduled:Se,windowRect:fe}),[F,q,k,K,ze,S,A,R,L,se,ve,ue,me,Ze,U,Se,fe]),cr=i.useMemo(()=>({activatorEvent:K,activators:Gt,active:F,activeNodeRect:k,ariaDescribedById:{draggable:je},dispatch:x,draggableNodes:R,over:ve,measureDroppableContainers:ue}),[K,Gt,F,k,x,je,R,ve,ue]);return H.createElement(Pn.Provider,{value:y},H.createElement(ft.Provider,{value:cr},H.createElement(Gn.Provider,{value:lr},H.createElement(Jn.Provider,{value:ar},f)),H.createElement(oo,{disabled:(c==null?void 0:c.restoreFocus)===!1})),H.createElement(as,{...c,hiddenTextDescribedById:je}));function dr(){const X=(ge==null?void 0:ge.autoScrollEnabled)===!1,J=typeof d=="object"?d.enabled===!1:d===!1,Q=C&&!X&&!J;return typeof d=="object"?{...d,enabled:Q}:{enabled:Q}}}),uo=i.createContext(null),wn="button",fo="Draggable";function ho(e){let{id:t,data:n,disabled:r=!1,attributes:o}=e;const a=Qe(fo),{activators:l,activatorEvent:c,active:d,activeNodeRect:f,ariaDescribedById:u,draggableNodes:h,over:m}=i.useContext(ft),{role:g=wn,roleDescription:w="draggable",tabIndex:v=0}=o??{},b=(d==null?void 0:d.id)===t,x=i.useContext(b?Jn:uo),[p,y]=st(),[j,N]=st(),C=_s(l,t),D=He(n);de(()=>(h.set(t,{id:t,key:a,node:p,activatorNode:j,data:D}),()=>{const O=h.get(t);O&&O.key===a&&h.delete(t)}),[h,t]);const R=i.useMemo(()=>({role:g,tabIndex:v,"aria-disabled":r,"aria-pressed":b&&g===wn?!0:void 0,"aria-roledescription":w,"aria-describedby":u.draggable}),[r,g,v,b,w,u.draggable]);return{active:d,activatorEvent:c,activeNodeRect:f,attributes:R,isDragging:b,listeners:r?void 0:C,node:p,over:m,setNodeRef:y,setActivatorNodeRef:N,transform:x}}function go(){return i.useContext(Gn)}const po="Droppable",mo={timeout:25};function vo(e){let{data:t,disabled:n=!1,id:r,resizeObserverConfig:o}=e;const a=Qe(po),{active:l,dispatch:c,over:d,measureDroppableContainers:f}=i.useContext(ft),u=i.useRef({disabled:n}),h=i.useRef(!1),m=i.useRef(null),g=i.useRef(null),{disabled:w,updateMeasurementsFor:v,timeout:b}={...mo,...o},x=He(v??r),p=i.useCallback(()=>{if(!h.current){h.current=!0;return}g.current!=null&&clearTimeout(g.current),g.current=setTimeout(()=>{f(Array.isArray(x.current)?x.current:[x.current]),g.current=null},b)},[b]),y=ut({callback:p,disabled:w||!l}),j=i.useCallback((R,O)=>{y&&(O&&(y.unobserve(O),h.current=!1),R&&y.observe(R))},[y]),[N,C]=st(j),D=He(t);return i.useEffect(()=>{!y||!N.current||(y.disconnect(),h.current=!1,y.observe(N.current))},[N,y]),i.useEffect(()=>(c({type:z.RegisterDroppable,element:{id:r,key:a,disabled:n,node:N,rect:m,data:D}}),()=>c({type:z.UnregisterDroppable,key:a,id:r})),[r]),i.useEffect(()=>{n!==u.current.disabled&&(c({type:z.SetDroppableDisabled,id:r,key:a,disabled:n}),u.current.disabled=n)},[r,a,n,c]),{active:l,rect:m,isOver:(d==null?void 0:d.id)===r,node:N,over:d,setNodeRef:C}}function Kt(e,t,n){const r=e.slice();return r.splice(n<0?r.length+n:n,0,r.splice(t,1)[0]),r}function bo(e,t){return e.reduce((n,r,o)=>{const a=t.get(r);return a&&(n[o]=a),n},Array(e.length))}function tt(e){return e!==null&&e>=0}function xo(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function wo(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const Qn=e=>{let{rects:t,activeIndex:n,overIndex:r,index:o}=e;const a=Kt(t,r,n),l=t[o],c=a[o];return!c||!l?null:{x:c.left-l.left,y:c.top-l.top,scaleX:c.width/l.width,scaleY:c.height/l.height}},nt={scaleX:1,scaleY:1},yo=e=>{var t;let{activeIndex:n,activeNodeRect:r,index:o,rects:a,overIndex:l}=e;const c=(t=a[n])!=null?t:r;if(!c)return null;if(o===n){const f=a[l];return f?{x:0,y:n<l?f.top+f.height-(c.top+c.height):f.top-c.top,...nt}:null}const d=Co(a,o,n);return o>n&&o<=l?{x:0,y:-c.height-d,...nt}:o<n&&o>=l?{x:0,y:c.height+d,...nt}:{x:0,y:0,...nt}};function Co(e,t,n){const r=e[t],o=e[t-1],a=e[t+1];return r?n<t?o?r.top-(o.top+o.height):a?a.top-(r.top+r.height):0:a?a.top-(r.top+r.height):o?r.top-(o.top+o.height):0:0}const Zn="Sortable",er=H.createContext({activeIndex:-1,containerId:Zn,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:Qn,disabled:{draggable:!1,droppable:!1}});function jo(e){let{children:t,id:n,items:r,strategy:o=Qn,disabled:a=!1}=e;const{active:l,dragOverlay:c,droppableRects:d,over:f,measureDroppableContainers:u}=go(),h=Qe(Zn,n),m=c.rect!==null,g=i.useMemo(()=>r.map(C=>typeof C=="object"&&"id"in C?C.id:C),[r]),w=l!=null,v=l?g.indexOf(l.id):-1,b=f?g.indexOf(f.id):-1,x=i.useRef(g),p=!xo(g,x.current),y=b!==-1&&v===-1||p,j=wo(a);de(()=>{p&&w&&u(g)},[p,g,w,u]),i.useEffect(()=>{x.current=g},[g]);const N=i.useMemo(()=>({activeIndex:v,containerId:h,disabled:j,disableTransforms:y,items:g,overIndex:b,useDragOverlay:m,sortedRects:bo(g,d),strategy:o}),[v,h,j.draggable,j.droppable,y,g,b,d,m,o]);return H.createElement(er.Provider,{value:N},t)}const So=e=>{let{id:t,items:n,activeIndex:r,overIndex:o}=e;return Kt(n,r,o).indexOf(t)},Do=e=>{let{containerId:t,isSorting:n,wasDragging:r,index:o,items:a,newIndex:l,previousItems:c,previousContainerId:d,transition:f}=e;return!f||!r||c!==a&&o===l?!1:n?!0:l!==o&&t===d},No={duration:200,easing:"ease"},tr="transform",Ro=qe.Transition.toString({property:tr,duration:0,easing:"linear"}),To={roleDescription:"sortable"};function ko(e){let{disabled:t,index:n,node:r,rect:o}=e;const[a,l]=i.useState(null),c=i.useRef(n);return de(()=>{if(!t&&n!==c.current&&r.current){const d=o.current;if(d){const f=Pe(r.current,{ignoreTransform:!0}),u={x:d.left-f.left,y:d.top-f.top,scaleX:d.width/f.width,scaleY:d.height/f.height};(u.x||u.y)&&l(u)}}n!==c.current&&(c.current=n)},[t,n,r,o]),i.useEffect(()=>{a&&l(null)},[a]),a}function Eo(e){let{animateLayoutChanges:t=Do,attributes:n,disabled:r,data:o,getNewIndex:a=So,id:l,strategy:c,resizeObserverConfig:d,transition:f=No}=e;const{items:u,containerId:h,activeIndex:m,disabled:g,disableTransforms:w,sortedRects:v,overIndex:b,useDragOverlay:x,strategy:p}=i.useContext(er),y=Mo(r,g),j=u.indexOf(l),N=i.useMemo(()=>({sortable:{containerId:h,index:j,items:u},...o}),[h,o,j,u]),C=i.useMemo(()=>u.slice(u.indexOf(l)),[u,l]),{rect:D,node:R,isOver:O,setNodeRef:L}=vo({id:l,data:N,disabled:y.droppable,resizeObserverConfig:{updateMeasurementsFor:C,...d}}),{active:M,activatorEvent:W,activeNodeRect:F,attributes:V,setNodeRef:ge,listeners:Ne,isDragging:K,over:Re,setActivatorNodeRef:re,transform:je}=ho({id:l,data:N,attributes:{...To,...n},disabled:y.draggable}),Te=Wr(L,ge),U=!!M,se=U&&!w&&tt(m)&&tt(b),ue=!x&&K,Se=ue&&se?je:null,ke=se?Se??(c??p)({rects:v,activeNodeRect:F,activeIndex:m,overIndex:b,index:j}):null,ae=tt(m)&&tt(b)?a({id:l,items:u,activeIndex:m,overIndex:b}):j,ee=M==null?void 0:M.id,k=i.useRef({activeId:ee,items:u,newIndex:ae,containerId:h}),S=u!==k.current.items,E=t({active:M,containerId:h,isDragging:K,isSorting:U,id:l,index:j,items:u,newIndex:k.current.newIndex,previousItems:k.current.items,previousContainerId:k.current.containerId,transition:f,wasDragging:k.current.activeId!=null}),I=ko({disabled:!E,index:j,node:R,rect:D});return i.useEffect(()=>{U&&k.current.newIndex!==ae&&(k.current.newIndex=ae),h!==k.current.containerId&&(k.current.containerId=h),u!==k.current.items&&(k.current.items=u)},[U,ae,h,u]),i.useEffect(()=>{if(ee===k.current.activeId)return;if(ee!=null&&k.current.activeId==null){k.current.activeId=ee;return}const Y=setTimeout(()=>{k.current.activeId=ee},50);return()=>clearTimeout(Y)},[ee]),{active:M,activeIndex:m,attributes:V,data:N,rect:D,index:j,newIndex:ae,items:u,isOver:O,isSorting:U,isDragging:K,listeners:Ne,node:R,overIndex:b,over:Re,setNodeRef:Te,setActivatorNodeRef:re,setDroppableNodeRef:L,setDraggableNodeRef:ge,transform:I??ke,transition:A()};function A(){if(I||S&&k.current.newIndex===j)return Ro;if(!(ue&&!Bt(W)||!f)&&(U||E))return qe.Transition.toString({...f,property:tr})}}function Mo(e,t){var n,r;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:t.draggable,droppable:(r=e==null?void 0:e.droppable)!=null?r:t.droppable}}function it(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const Io=[T.Down,T.Right,T.Up,T.Left],Ao=(e,t)=>{let{context:{active:n,collisionRect:r,droppableRects:o,droppableContainers:a,over:l,scrollableAncestors:c}}=t;if(Io.includes(e.code)){if(e.preventDefault(),!n||!r)return;const d=[];a.getEnabled().forEach(h=>{if(!h||h!=null&&h.disabled)return;const m=o.get(h.id);if(m)switch(e.code){case T.Down:r.top<m.top&&d.push(h);break;case T.Up:r.top>m.top&&d.push(h);break;case T.Left:r.left>m.left&&d.push(h);break;case T.Right:r.left<m.left&&d.push(h);break}});const f=ds({collisionRect:r,droppableRects:o,droppableContainers:d});let u=Bn(f,"id");if(u===(l==null?void 0:l.id)&&f.length>1&&(u=f[1].id),u!=null){const h=a.get(n.id),m=a.get(u),g=m?o.get(m.id):null,w=m==null?void 0:m.node.current;if(w&&g&&h&&m){const b=dt(w).some((C,D)=>c[D]!==C),x=nr(h,m),p=Oo(h,m),y=b||!x?{x:0,y:0}:{x:p?r.width-g.width:0,y:p?r.height-g.height:0},j={x:g.left,y:g.top};return y.x&&y.y?j:We(j,y)}}}};function nr(e,t){return!it(e)||!it(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function Oo(e,t){return!it(e)||!it(t)||!nr(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}const yn=["bg-muted","bg-project/10","bg-green-50 dark:bg-green-900/20","bg-blue-50 dark:bg-blue-900/20","bg-orange-50 dark:bg-orange-900/20","bg-purple-50 dark:bg-purple-900/20"],Lo=({column:e,onRename:t,onRemove:n,disabled:r})=>{const{attributes:o,listeners:a,setNodeRef:l,transform:c,transition:d,isDragging:f}=Eo({id:e.id}),u={transform:qe.Transform.toString(c),transition:d,opacity:f?.5:1};return s.jsxs("div",{ref:l,style:u,className:"flex items-center gap-2 p-2 rounded-lg border bg-card",children:[s.jsx("div",{...o,...a,className:"cursor-grab active:cursor-grabbing",children:s.jsx(zr,{className:"w-4 h-4 text-muted-foreground"})}),s.jsx("div",{className:`w-4 h-4 rounded ${e.color}`}),s.jsx(Ye,{value:e.name,onChange:h=>t(h.target.value),className:"flex-1 h-8"}),s.jsx(P,{variant:"ghost",size:"icon",className:"h-8 w-8 text-destructive",onClick:n,disabled:r,children:s.jsx(At,{className:"w-4 h-4"})})]})},Po=({columns:e,onColumnsChange:t,isOpen:n,onClose:r})=>{const[o,a]=i.useState(e),[l,c]=i.useState(!1);i.useEffect(()=>{a(e)},[e]);const[d,f]=i.useState(""),u=is(ln(Vt),ln(Ut,{coordinateGetter:Ao})),h=x=>{const{active:p,over:y}=x;if(y&&p.id!==y.id){const j=o.findIndex(C=>C.id===p.id),N=o.findIndex(C=>C.id===y.id);a(Kt(o,j,N))}},m=()=>{if(!d.trim()||o.length>=6)return;const x={id:`custom-${Date.now()}`,name:d.trim(),color:yn[o.length%yn.length],order:o.length};a([...o,x]),f("")},g=x=>{o.length<=2||a(o.filter(p=>p.id!==x))},w=(x,p)=>{a(o.map(y=>y.id===x?{...y,name:p}:y))},v=async()=>{c(!0);try{const x=o.map((p,y)=>({...p,order:y}));await t(x),r()}finally{c(!1)}},b=()=>{a(Lt)};return s.jsx(Rn,{open:n,onOpenChange:r,children:s.jsxs(Tn,{className:"sm:max-w-[500px]",children:[s.jsxs(kn,{children:[s.jsx(En,{children:"GÃ©rer les colonnes Kanban"}),s.jsx(vr,{children:"Personnalisez les colonnes de votre tableau Kanban. Maximum 6 colonnes."})]}),s.jsxs("div",{className:"space-y-4 py-4",children:[s.jsx(co,{sensors:u,collisionDetection:cs,onDragEnd:h,children:s.jsx(jo,{items:o.map(x=>x.id),strategy:yo,children:s.jsx("div",{className:"space-y-2",children:o.map(x=>s.jsx(Lo,{column:x,onRename:p=>w(x.id,p),onRemove:()=>g(x.id),disabled:o.length<=2},x.id))})})}),o.length<6&&s.jsxs("div",{className:"flex items-end gap-2",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx(ye,{htmlFor:"new-column",children:"Nouvelle colonne"}),s.jsx(Ye,{id:"new-column",value:d,onChange:x=>f(x.target.value),placeholder:"Nom de la colonne",onKeyDown:x=>x.key==="Enter"&&m()})]}),s.jsxs(P,{onClick:m,disabled:!d.trim(),children:[s.jsx(Mn,{className:"w-4 h-4 mr-1"}),"Ajouter"]})]})]}),s.jsxs(br,{className:"flex justify-between",children:[s.jsx(P,{variant:"outline",onClick:b,children:"RÃ©initialiser"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(P,{variant:"outline",onClick:r,children:"Annuler"}),s.jsx(P,{onClick:v,disabled:l,children:l?"Enregistrement...":"Enregistrer"})]})]})]})})},zo=({project:e,onBack:t,onEdit:n,onDelete:r})=>{var k;const{getTasksByColumns:o,updateTaskStatus:a,reloadTasks:l}=Vr(e.id),{addTask:c,updateTask:d,removeTask:f}=xr(),{deleteProject:u,completeProject:h,updateProject:m}=In(),{toast:g}=wr(),[w,v]=i.useState(!1),[b,x]=i.useState(null),[p,y]=i.useState(""),[j,N]=i.useState("none"),[C,D]=i.useState("all"),[R,O]=i.useState(!1),L=i.useMemo(()=>e.kanbanColumns||Lt,[e.kanbanColumns]),M=Ot[e.status],W=i.useCallback(S=>{let E=[...S];if(p.trim()){const I=p.toLowerCase();E=E.filter(A=>A.name.toLowerCase().includes(I))}return C!=="all"&&(C==="none"?E=E.filter(I=>!I.subCategory):E=E.filter(I=>I.subCategory===C)),j!=="none"&&E.sort((I,A)=>{switch(j){case"priority-high":{const Y=pe=>{var fe;return pe.subCategory?((fe=Rt[pe.subCategory])==null?void 0:fe.priority)??0:0},_=Y(I),ie=Y(A);return ie===_?I.name.localeCompare(A.name):ie-_}case"priority-low":{const Y=pe=>{var fe;return pe.subCategory?((fe=Rt[pe.subCategory])==null?void 0:fe.priority)??0:0},_=Y(I),ie=Y(A);return _===0&&ie!==0?1:ie===0&&_!==0?-1:_===ie?I.name.localeCompare(A.name):_-ie}case"name":return I.name.localeCompare(A.name);case"time":return(A.estimatedTime||0)-(I.estimatedTime||0);default:return 0}}),E},[p,j,C]),F=i.useMemo(()=>{const S=o(L),E={};return Object.entries(S).forEach(([I,A])=>{E[I]=W(A)}),E},[L,o,W]),V=i.useMemo(()=>{var Y;const E=Object.values(F).flat().length,I=((Y=F.done)==null?void 0:Y.length)||0,A=E>0?Math.round(I/E*100):0;return{total:E,done:I,progress:A}},[F]),ge=p.trim()!==""||j!=="none"||C!=="all",Ne=i.useCallback(()=>{y(""),N("none"),D("all")},[]),K=i.useCallback(async()=>{window.confirm(`ÃŠtes-vous sÃ»r de vouloir supprimer le projet "${e.name}" ? Cette action est irrÃ©versible.`)&&await u(e.id)&&r&&r()},[e.id,e.name,u,r]),Re=i.useCallback(async()=>{window.confirm(`Marquer le projet "${e.name}" comme terminÃ© ?`)&&await h(e.id)&&r&&r()},[e.id,e.name,h,r]),re=i.useCallback(async()=>{const S=e.showInSidebar??!1;await m(e.id,{showInSidebar:!S}),g({title:S?"MasquÃ© de la sidebar":"AffichÃ© dans la sidebar",description:S?"Les tÃ¢ches de ce projet ne s'affichent plus dans la sidebar":"Les tÃ¢ches de ce projet apparaissent maintenant dans la sidebar"})},[e,m,g]),je=i.useCallback(async S=>{await m(e.id,{kanbanColumns:S})&&(l(),g({title:"Colonnes mises Ã  jour",description:"La configuration du tableau Kanban a Ã©tÃ© sauvegardÃ©e."}))},[e.id,m,l,g]),Te=i.useCallback(S=>{x(S),v(!0)},[]),U=i.useCallback(async S=>{const I=Object.values(F).flat().find(A=>A.id===S);if(I){const A=I.isCompleted?"todo":"done";await a(S,A)}},[F,a]),se=i.useCallback(async S=>{await f(S),l(),g({title:"TÃ¢che supprimÃ©e",description:"La tÃ¢che a Ã©tÃ© supprimÃ©e avec succÃ¨s."})},[f,l,g]),ue=i.useCallback(()=>{x(null),v(!0)},[]),Se=i.useCallback(()=>{v(!1),x(null),l()},[l]),q=i.useCallback(async S=>{await c(S),l()},[c,l]),ke=i.useCallback(async(S,E)=>{await d(S,E),l()},[d,l]),ae=[{value:"all",label:"Toutes les prioritÃ©s"},{value:"Le plus important",label:"ðŸ”´ Le plus important"},{value:"Important",label:"ðŸŸ  Important"},{value:"Peut attendre",label:"ðŸŸ¡ Peut attendre"},{value:"Si j'ai le temps",label:"ðŸŸ¢ Si j'ai le temps"},{value:"none",label:"âšª Non dÃ©finie"}],ee=[{value:"none",label:"Aucun tri"},{value:"priority-high",label:"PrioritÃ© â†“ (haute â†’ basse)"},{value:"priority-low",label:"PrioritÃ© â†‘ (basse â†’ haute)"},{value:"name",label:"Nom (A â†’ Z)"},{value:"time",label:"DurÃ©e (longue â†’ courte)"}];return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-start justify-between flex-wrap gap-4",children:[s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx(P,{variant:"ghost",size:"icon",onClick:t,children:s.jsx(yr,{className:"w-5 h-5"})}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"text-3xl",children:e.icon||"ðŸ“š"}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold",children:e.name}),s.jsx(De,{className:`${M.bgColor} ${M.color} mt-1`,children:M.label})]})]}),e.description&&s.jsx("p",{className:"text-muted-foreground max-w-2xl",children:e.description})]})]}),s.jsxs("div",{className:"flex gap-2 flex-wrap items-center",children:[s.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 rounded-md border bg-card",children:[s.jsx(Cr,{id:"show-in-sidebar",checked:e.showInSidebar??!1,onCheckedChange:re}),s.jsx(ye,{htmlFor:"show-in-sidebar",className:"text-sm cursor-pointer flex items-center gap-1",children:e.showInSidebar?s.jsxs(s.Fragment,{children:[s.jsx(jr,{className:"w-4 h-4 text-project"})," Sidebar"]}):s.jsxs(s.Fragment,{children:[s.jsx(Sr,{className:"w-4 h-4 text-muted-foreground"})," Sidebar"]})})]}),s.jsx(P,{variant:"outline",size:"sm",className:"h-auto py-2",onClick:()=>O(!0),children:s.jsx(sn,{className:"w-4 h-4"})}),s.jsxs(P,{variant:"outline",onClick:n,children:[s.jsx(Dr,{className:"w-4 h-4 mr-2"}),"Modifier"]}),e.status!=="completed"&&s.jsxs(P,{variant:"outline",onClick:Re,className:"text-green-600 border-green-600 hover:bg-green-50 hover:text-green-700",children:[s.jsx(Nr,{className:"w-4 h-4 mr-2"}),"Terminer"]}),s.jsxs(P,{variant:"destructive",onClick:K,children:[s.jsx(At,{className:"w-4 h-4 mr-2"}),"Supprimer"]}),s.jsxs(P,{onClick:ue,className:"bg-project hover:bg-project/90 text-white",children:[s.jsx(Fr,{className:"w-4 h-4 mr-2"}),"Ajouter au projet"]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"bg-card p-4 rounded-lg border",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Progression"}),s.jsxs("p",{className:"text-2xl font-bold",children:[V.progress,"%"]})]}),s.jsx(Rr,{className:"w-8 h-8 text-project"})]}),s.jsx(Dn,{value:V.progress,className:"mt-2"})]}),e.targetDate&&s.jsx("div",{className:"bg-card p-4 rounded-lg border",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Date cible"}),s.jsx("p",{className:"text-lg font-semibold",children:new Date(e.targetDate).toLocaleDateString("fr-FR",{day:"numeric",month:"long"})})]}),s.jsx(Nn,{className:"w-8 h-8 text-blue-500"})]})}),s.jsx("div",{className:"bg-card p-4 rounded-lg border",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"TÃ¢ches totales"}),s.jsx("p",{className:"text-2xl font-bold",children:V.total})]}),s.jsxs("div",{className:"text-sm text-muted-foreground",children:[V.done," terminÃ©es"]})]})})]}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 p-4 bg-muted/30 rounded-lg border",children:[s.jsxs("div",{className:"relative flex-1",children:[s.jsx(Tr,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),s.jsx(Ye,{type:"text",placeholder:"Rechercher une tÃ¢che...",value:p,onChange:S=>y(S.target.value),className:"pl-10 bg-background"})]}),s.jsxs(Jt,{children:[s.jsx(Qt,{asChild:!0,children:s.jsxs(P,{variant:C!=="all"?"default":"outline",className:"gap-2",children:[s.jsx(kr,{className:"w-4 h-4"}),s.jsx("span",{className:"hidden sm:inline",children:C==="all"?"PrioritÃ©":C})]})}),s.jsxs(Zt,{align:"end",className:"w-56",children:[s.jsx(en,{children:"Filtrer par prioritÃ©"}),s.jsx(tn,{}),ae.map(S=>s.jsx(nn,{onClick:()=>D(S.value),className:C===S.value?"bg-accent":"",children:S.label},S.value))]})]}),s.jsxs(Jt,{children:[s.jsx(Qt,{asChild:!0,children:s.jsxs(P,{variant:j!=="none"?"default":"outline",className:"gap-2",children:[s.jsx(Er,{className:"w-4 h-4"}),s.jsx("span",{className:"hidden sm:inline",children:"Trier"})]})}),s.jsxs(Zt,{align:"end",className:"w-56",children:[s.jsx(en,{children:"Trier les tÃ¢ches"}),s.jsx(tn,{}),ee.map(S=>s.jsx(nn,{onClick:()=>N(S.value),className:j===S.value?"bg-accent":"",children:S.label},S.value))]})]}),ge&&s.jsx(P,{variant:"ghost",size:"icon",onClick:Ne,children:s.jsx(Mr,{className:"w-4 h-4"})})]}),ge&&s.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[s.jsx("span",{children:"Filtres actifs :"}),p&&s.jsxs(De,{variant:"secondary",className:"gap-1",children:['Recherche: "',p,'"']}),C!=="all"&&s.jsx(De,{variant:"secondary",className:"gap-1",children:C}),j!=="none"&&s.jsxs(De,{variant:"secondary",className:"gap-1",children:["Tri: ",(k=ee.find(S=>S.value===j))==null?void 0:k.label]})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h2",{className:"text-xl font-semibold",children:"Tableau Kanban"}),s.jsxs(P,{variant:"outline",size:"sm",onClick:()=>O(!0),children:[s.jsx(sn,{className:"w-4 h-4 mr-2"}),"Colonnes"]})]}),s.jsx(Hr,{tasksByColumn:F,columns:L,onStatusChange:a,onTaskClick:Te,onToggleComplete:U,onDeleteTask:se})]}),s.jsx(Po,{columns:L,onColumnsChange:je,isOpen:R,onClose:()=>O(!1)}),w&&s.jsx(Ir,{isOpen:w,onClose:Se,editingTask:b||void 0,projectId:e.id,taskType:"project",onAddTask:q,onUpdateTask:ke})]})},$o=()=>{const{projects:e,loading:t,createProject:n,updateProject:r}=In(),[o,a]=i.useState(!1),[l,c]=i.useState(null),[d,f]=i.useState(null),u=async p=>{await n(p.name,p.description,p.icon,p.color),a(!1)},h=async p=>{l&&(await r(l.id,p),a(!1),c(null),d&&d.id===l.id&&f(null))},m=p=>{f(p)},g=()=>{c(d),a(!0)};if(d)return s.jsxs(s.Fragment,{children:[s.jsx(zo,{project:d,onBack:()=>f(null),onEdit:g,onDelete:()=>f(null)}),s.jsx(on,{open:o,onClose:()=>{a(!1),c(null)},onSave:h,project:l})]});const w=e.filter(p=>p.status!=="archived"&&p.status!=="completed"),v=e.filter(p=>p.status==="completed"),b=e.filter(p=>p.status==="archived"),x=()=>s.jsxs("div",{className:`border-2 border-dashed rounded-lg p-6 flex flex-col items-center justify-center gap-3\r
        transition-all duration-200 min-h-[200px]\r
        border-border bg-card hover:border-muted-foreground/50 cursor-pointer`,onClick:()=>a(!0),children:[s.jsx(rn,{className:"w-10 h-10 text-muted-foreground"}),s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"font-medium",children:"Nouveau projet"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Cliquez pour crÃ©er un projet"})]})]});return s.jsxs(Pr,{header:{title:"Projets",subtitle:"GÃ©rez vos projets complexes avec des tÃ¢ches organisÃ©es",icon:s.jsx(Lr,{className:"w-5 h-5"}),actions:s.jsxs(P,{onClick:()=>a(!0),children:[s.jsx(Mn,{className:"w-4 h-4 mr-2"}),"Nouveau projet"]})},state:t?"loading":e.length===0?"empty":"success",loadingProps:{variant:"cards"},emptyProps:{title:"Aucun projet",description:"CrÃ©ez votre premier projet pour organiser vos tÃ¢ches",icon:s.jsx(rn,{className:"w-12 h-12"}),action:{label:"CrÃ©er un projet",onClick:()=>a(!0)}},children:[s.jsxs(Ar,{defaultValue:"active",className:"w-full",children:[s.jsxs(Or,{children:[s.jsxs(wt,{value:"active",children:["Actifs (",w.length,")"]}),s.jsxs(wt,{value:"completed",children:["TerminÃ©s (",v.length,")"]}),b.length>0&&s.jsxs(wt,{value:"archived",children:["ArchivÃ©s (",b.length,")"]})]}),s.jsx(yt,{value:"active",className:"mt-6",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[w.map(p=>s.jsx(Ct,{project:p,onClick:()=>m(p)},p.id)),s.jsx(x,{})]})}),s.jsx(yt,{value:"completed",className:"mt-6",children:s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:v.map(p=>s.jsx(Ct,{project:p,onClick:()=>m(p)},p.id))})}),b.length>0&&s.jsx(yt,{value:"archived",className:"mt-6",children:s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:b.map(p=>s.jsx(Ct,{project:p,onClick:()=>m(p)},p.id))})})]}),s.jsx(on,{open:o,onClose:()=>{a(!1),c(null)},onSave:l?h:u,project:l})]})};export{$o as default};
