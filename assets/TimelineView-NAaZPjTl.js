import{c as H,r as i,v as w,w as M,x as p,y as z,z as y,j as e,D as f,f as g,t as S,d as x,E as B,F as I,C as J,a as L,b as R,e as F,G as O,l as P,J as C}from"./index-OkmmFMeI.js";import{V as X}from"./ViewLayout-Bnv45DD-.js";import{V as $}from"./ViewStats-BcyeRM-K.js";import{f as q,g as G}from"./formatters-BjN0d5cq.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=H("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),Q=()=>{const[d,l]=i.useState(new Date),[s,r]=i.useState("day"),v=i.useMemo(()=>s==="day"?{start:M(d),end:w(d)}:{start:M(d),end:w(p(d,6))},[d,s]),{occurrences:n,events:o,loading:a,completeEvent:m,totalBusyTime:u,totalFreeTime:j}=z(v),N=i.useMemo(()=>{const t=new Map;return n.forEach(c=>{const h=y(c.startsAt,"yyyy-MM-dd");t.has(h)||t.set(h,[]),t.get(h).push(c)}),t.forEach(c=>{c.sort((h,V)=>h.startsAt.getTime()-V.startsAt.getTime())}),t},[n]),b=i.useMemo(()=>({totalEvents:n.length,completedEvents:n.filter(t=>t.status==="completed").length,busyHours:Math.round(u/60),freeHours:Math.round(j/60)}),[n,u,j]),E=i.useCallback(()=>{l(t=>p(t,s==="day"?-1:-7))},[s]),k=i.useCallback(()=>{l(t=>p(t,s==="day"?1:7))},[s]),D=i.useCallback(()=>{l(new Date)},[]),T=i.useCallback(t=>{r(t)},[]),A=i.useCallback(t=>o.find(c=>c.id===t),[o]);return{data:{occurrences:n,occurrencesByDay:N,events:o,stats:b,selectedDate:d,dateRange:v},state:{loading:a,isEmpty:n.length===0,viewMode:s},actions:{completeEvent:m,handlePrevious:E,handleNext:k,handleToday:D,setViewMode:T,getEventById:A}}},_=({className:d})=>{const{data:l,state:s,actions:r}=Q(),v=[{id:"events",label:"Événements",value:l.stats.totalEvents,icon:e.jsx(f,{className:"w-4 h-4"})},{id:"completed",label:"Terminés",value:l.stats.completedEvents,icon:e.jsx(g,{className:"w-4 h-4"})},{id:"busy",label:"Heures occupées",value:`${l.stats.busyHours}h`,icon:e.jsx(S,{className:"w-4 h-4"})}];return e.jsx(X,{header:{title:"Timeline",subtitle:"Visualisez votre planning",icon:e.jsx(f,{className:"w-5 h-5"})},state:s.loading?"loading":"success",className:d,children:e.jsxs("div",{className:"space-y-6 pb-20 md:pb-6",children:[e.jsx($,{stats:v,columns:3}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(x,{variant:"outline",size:"sm",onClick:r.handlePrevious,children:[e.jsx(B,{className:"w-4 h-4 mr-1"}),s.viewMode==="day"?"Jour précédent":"Semaine précédente"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{variant:"ghost",size:"sm",onClick:r.handleToday,children:"Aujourd'hui"}),e.jsx("span",{className:"font-medium",children:y(l.selectedDate,s.viewMode==="day"?"EEEE d MMMM":"'Semaine du' d MMMM",{locale:C})})]}),e.jsxs(x,{variant:"outline",size:"sm",onClick:r.handleNext,children:[s.viewMode==="day"?"Jour suivant":"Semaine suivante",e.jsx(I,{className:"w-4 h-4 ml-1"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(x,{variant:s.viewMode==="day"?"default":"outline",size:"sm",onClick:()=>r.setViewMode("day"),children:"Jour"}),e.jsx(x,{variant:s.viewMode==="week"?"default":"outline",size:"sm",onClick:()=>r.setViewMode("week"),children:"Semaine"})]}),s.isEmpty?e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx(f,{className:"w-12 h-12 mx-auto mb-4 opacity-40"}),e.jsx("p",{children:"Aucun événement prévu"})]}):e.jsx("div",{className:"space-y-4",children:Array.from(l.occurrencesByDay.entries()).map(([n,o])=>e.jsxs(J,{children:[e.jsx(L,{className:"pb-2",children:e.jsx(R,{className:"text-sm font-medium text-muted-foreground",children:y(new Date(n),"EEEE d MMMM",{locale:C})})}),e.jsx(F,{className:"space-y-2",children:o.map(a=>{const m=r.getEventById(a.eventId),u=a.endsAt?O(a.endsAt,a.startsAt):0;return e.jsxs("div",{className:P("flex items-center justify-between p-3 rounded-lg border",G(a.status)),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"text-sm font-medium",children:[y(a.startsAt,"HH:mm"),a.endsAt&&` - ${y(a.endsAt,"HH:mm")}`]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:(m==null?void 0:m.title)||"Événement"}),u>0&&e.jsx("p",{className:"text-xs text-muted-foreground",children:q(u)})]})]}),a.status==="completed"?e.jsx(g,{className:"w-5 h-5 text-system-success"}):a.status==="missed"?e.jsx(K,{className:"w-5 h-5 text-system-error"}):null]},a.id)})})]},n))})]})})};export{_ as default};
